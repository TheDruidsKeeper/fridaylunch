<!DOCTYPE html>
<html ng-app="lunchApp">

<head>
    <title>Friday Lunch</title>
    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="css/bootstrap-combobox.css" />
    <link rel="stylesheet" href="css/main.css" />
    <script type="text/javascript" src="js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/bootstrap-combobox.js"></script>
    <script type="text/javascript" src="js/angular.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
    <script src="https://apis.google.com/js/client:platform.js?onload=apiClientLoaded" async defer></script>
</head>

<body onload="dayFinder()" ng-controller="LunchController">
    <div id="bg">
        <img src="img/pic.jpg" alt="">
    </div>
    <div class="container">
        <div class="row clearfix">
            <div class="col-xs-3">
                <div class="row controls">
                    <form class="well" ng-submit="send()">
                        <table class="table table-striped table-hover table-condensed table-bordered" id="chatTable">
                            <thead>
                                <tr>
                                    <th class="col-xs-1">Name </th>
                                    <th class="col-xs-11">Text</th>
                                </tr>
                            </thead>
                        </table>
                        <div class="row">
                            <div id="chatWindow" class="col-xs-12" scroll-glue>
                                <table class="table table-striped table-hover table-condensed" id="chatTable">
                                    <tbody>
                                        <tr ng-repeat="msg in messages">
                                            <td>{{msg.name}}</td>
                                            <td>{{msg.text}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="input-append">
                            <input class="col-xs-11" type="text" ng-model="text" placeholder="Message" id="chatBox" ng-hide="user == null || user == '' || user=='undefinded'">
                            <ul class="nav nav-list well">
                                <li>
                                    <h4>Current Users ({{roster.length}})</h4>
                                </li>
                                <li ng-repeat="user in roster" ng-bind="user"></li>
                            </ul>
                        </div>
                    </form>
                </div>
            </div>
            <div class="jumbotron col-xs-8 column text-center" ng-hide="winner==null">
                <p class="text-center">
                    <h2>{{winner.name}} please call</h2>
                    <h1>{{winner.location}}</h1>
                    <h4>{{winner.phone}}</h4>
                    <h4>make a reservation for {{winner.participants}}ish person(s)</h4>
                </p>
            </div>
            <div class="jumbotron col-xs-9 column" ng-show="winner==null">
                <button ng-click="signOut()" class="btn btn-danger" style="float: right" ng-hide="user == null || user == '' || user=='undefinded'">Sign out</button>
                <div>
                    <h2 id="day"></h2>
                    <p class="text-justify"><small id="message"></small>
                    </p>
                </div>
                <form id="nonFriday">
                    <a href="#myModal1" role="button" class="btn btn-primary" data-toggle="modal">Past Winners</a>
                    <div class="modal fade" id="myModal1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                                    <h4 class="modal-title" id="myModalLabel">Past Winners</h4>
                                </div>
                                <div class="modal-body">
                                    <table class="table table-hover table-condensed" id="winnerTable1">
                                        <thead>
                                            <tr>
                                                <th>Winner</th>
                                                <th>Location</th>
                                                <th>Date</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="winner in winners | orderBy: '-date'">
                                                <td>{{winner.location}}</td>
                                                <td>{{winner.name}}</td>
                                                <td>{{winner.participants}}</td>
                                                <td>{{winner.date.toDateString()}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
                <form role="form" id="form">
                    Current time: <span id="cd"></span>
                    <br/>
                    <div class=" form-group col-xs-8 col-xs-offset-2">
                        <label></label>
                        <div style="display: none">
                            <input class="form-control" required="required" ng-model="user" placeholder="Your Name" id="nameBox" />
                        </div>
                        <span id="signinButton" ng-show="user == null || user == '' || user=='undefinded'">
                            <span
                            class="g-signin"
                            data-callback="onSignInCallback"
                            data-clientid="735558191208-vse4n2aer044dat3b7rmsa0eudn3o59b.apps.googleusercontent.com"
                            data-cookiepolicy="single_host_origin"
                            data-width="wide"
                            data-scope="email">
                            </span>
                        </span>
                    </div>
                    <div ng-show="user == null || user == ''" class="col-xs-8 col-xs-offset-2">
                        <h2>Please sign in before attempting to vote</h2>
                    </div>
                    <div ng-hide="user == null || user == ''" class="form-group col-xs-8 col-xs-offset-2">
                        <select ng-model="location" ng-options="location.name as location.name for location in locations" ng-change="submitLocation()" class="form-control combobox" required="required"></select>
                    </div>
                    <div class="row">
                        <div class="form-group col-xs-8 col-xs-offset-2">
                            <a href="#myModal" role="button" id="pastWinnerButton" class="btn btn-primary" data-toggle="modal">Past Winners</a>
                        </div>
                        <div class="form-group col-xs-8 col-xs-offset-2" id="modalContainer">
                            <div class="modal fade" id="myModal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
                                            <h4 class="modal-title" id="myModalLabel1">Past Winners</h4>
                                        </div>
                                        <div class="modal-body">
                                            <table class="table table-hover table-condensed" id="winnerTable">
                                                <thead>
                                                    <tr>
                                                        <th>Location</th>
                                                        <th>Winner</th>
                                                        <th>Participants</th>
                                                        <th>Date</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="winner in winners | orderBy: '-date'">
                                                        <td>{{winner.location}}</td>
                                                        <td>{{winner.name}}</td>
                                                        <td>{{winner.participants}}</td>
                                                        <td>{{winner.date.toDateString()}}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <h4 class="col-xs-12 text-center">Today's Submissions</h4>
                        <table class="col-xs-12 table table-hover">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Location</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tbody>
                                    <tr ng-repeat="sub in submissions | orderBy:['location','name']">
                                        <td class="col-xs-3" ng-bind="sub.name"></td>
                                        <td class="col-xs-9" ng-bind="sub.location"></td>
                                    </tr>
                                </tbody>
                        </table>
                    </div>
            </div>
            </form>
        </div>
    </div>
    </div>

    <script type="text/javascript">
        $('#myModal').on('shown.bs.modal', function() {
            $('#myInput').focus();
        });
        $('#myModal1').on('shown.bs.modal', function() {
            $('#myInput').focus();
        });
    </script>
</body>

</html>